

import { FormData } from "../types";

// ------------------------------------------------------------------
// LOCAL GENERATION ENGINE (Modular Dynamic Assembly)
// ------------------------------------------------------------------
// This engine uses a "Lego-brick" approach to generate messages.
// Instead of 100 fixed sentences, we have components (Intro + Middle + End).
// Example: 10 Intros * 10 Middles * 10 Ends = 1,000 unique combinations.
// This ensures high variety, zero cost, and zero latency.

// Helper to pick a random item from an array
const pick = <T>(arr: T[]): T => arr[Math.floor(Math.random() * arr.length)];

// ==========================================
// 1. FLOWER STYLE (Strict Rhyme & Fixed Name Logic)
// ==========================================

interface RhymeEntry {
  key: string;      // The Adjective or Exclamation
  rhymes: string[]; // Phrases matching the rhyme
}

// FIX: Titles unified to 2 characters for rhythm balance.
const GROOM_NAME = "仁德";
const GROOM_TITLES = ["哥哥", "歐爸", "新郎", "帥哥", "男神", "老公", "巨星", "弟弟", "寶貝", "大叔"];

const BRIDE_NAME = "雯惠";
const BRIDE_TITLES = ["姊姊", "新娘", "仙女", "女神", "公主", "老婆", "女王", "妹妹", "寶貝", "水水"];

// Adjective Rhymes (Ends with char) + Emojis
const GROOM_ADJ_RHYMES: RhymeEntry[] = [
  { key: "帥", rhymes: ["真的有夠帥😎", "宇宙無敵帥✨", "新郎超級帥🔥", "帥到不科學😱", "全場我也帥🕺", "顏值天花板帥", "比劉德華還帥", "墨鏡戴好帥🕶️", "走路姿勢帥", "髮型超級帥", "五官超級帥", "魅力超級帥", "眼神超級帥", "今天特別帥", "人見人愛帥", "迷倒眾生帥", "破表超級帥", "無人能敵帥", "讓人尖叫帥", "真的是太帥"] },
  { key: "猛", rhymes: ["身材超級猛💪", "今晚特別猛🐯", "體格有夠猛", "做事超級猛", "氣勢超級猛🔥", "肌肉超級猛", "眼神超級猛", "全場你最猛", "伴郎都沒你猛", "體力超級猛⚡", "二頭肌超猛", "核心超級猛", "背肌超級猛", "大腿超級猛", "腰力超級猛", "火力超級猛", "氣場超級猛", "真的是很猛", "看起來好猛", "簡直超級猛"] },
  { key: "酷", rhymes: ["表情有夠酷😎", "裝扮超級酷", "墨鏡戴好酷", "走路有風酷🌬️", "不笑時候酷", "笑起來更酷", "眼神超級酷", "pose擺好酷📸", "全場第一酷", "風格超級酷", "單手插口袋酷", "領帶打好酷", "髮型有夠酷", "態度超級酷", "簡直超級酷", "真的有夠酷", "氣場超級酷", "外型超級酷", "舉手投足酷", "真的是太酷"] },
  { key: "壯", rhymes: ["肩膀有夠壯🏋️", "像頭牛一樣壯🐂", "手臂超級壯", "胸肌超級壯", "背肌超級壯", "看起來好壯", "真的很強壯💪", "保護老婆壯", "體格超級壯", "穿衣顯瘦壯", "脫衣有肉壯", "這身材真壯", "線條超級壯", "肌肉超級壯", "全身超級壯", "就像浩克壯", "真的是很壯", "結實超級壯", "男人味超壯", "讓人羨慕壯"] },
  { key: "棒", rhymes: ["表現超級棒👍", "老婆說很棒", "做人超級棒", "體力超級棒⚡", "身材超級棒", "運氣超級棒", "一切都很棒", "這場婚禮棒", "感覺超級棒✨", "氣氛超級棒", "真的有夠棒", "大家都說棒", "眼光超級棒", "能力超級棒", "什麼都好棒", "絕對超級棒", "真的是太棒", "肯定超級棒", "超級無敵棒", "一級棒棒棒"] },
  { key: "神", rhymes: ["運氣超級神🙏", "像個男神✨", "操作超級神", "眼光超級神", "直覺超級神", "把妹超級神", "簡直就是神", "帥度超級神", "魅力超級神", "這招真的神", "老婆選得神", "根本就是神", "預測超級神", "反應超級神", "智商超級神", "真的有夠神", "就像是財神", "幸運超級神", "技術超級神", "真的是太神"] },
];

const BRIDE_ADJ_RHYMES: RhymeEntry[] = [
  { key: "美", rhymes: ["真的有夠美💖", "世界第一美🌏", "氣質太完美✨", "看了不後悔", "仙女下凡美🧚‍♀️", "全場妳最美", "驚豔全場美", "360度美", "無法形容美", "連背影都美", "笑容超級美😊", "妝髮超級美", "心靈超級美", "眼神超級美", "怎麼樣都美", "天生超級美", "無敵超級美", "極致超級美", "大家都說美", "真的是太美"] },
  { key: "正", rhymes: ["身材超級正🔥", "五官超級正", "全場妳最正", "素顏也超正", "怎麼看都正😍", "伴娘沒妳正", "氣場超級正", "曲線超級正", "眼神超級正", "臉蛋超級正", "今日妳最正", "氣色超級正", "絕對超級正", "真的有夠正", "簡直超級正", "超級無敵正", "無死角超正", "氣質超級正", "打扮超級正", "真的是太正"] },
  { key: "甜", rhymes: ["笑容超級甜🍬", "心裡比蜜甜", "比全糖還甜", "聲音超級甜🎤", "嘴角超級甜", "眼神超級甜", "長相超級甜", "說話超級甜", "就像初戀甜💕", "空氣變好甜", "酒窩超級甜", "撒嬌超級甜", "味道超級甜", "心裡超級甜", "真的有夠甜", "超級無敵甜", "讓人融化甜", "幸福超級甜", "看起來好甜", "真的是太甜"] },
  { key: "仙", rhymes: ["氣質超級仙🧚", "快樂似神仙", "美得像天仙", "雲端上的仙☁️", "走路超級仙", "飄逸超級仙", "不食煙火仙", "溫柔超級仙", "夢幻超級仙✨", "全場第一仙", "回眸超級仙", "長髮超級仙", "真的有夠仙", "超級無敵仙", "簡直就是仙", "凡人無法仙", "打扮超級仙", "眼神超級仙", "笑容超級仙", "真的是太仙"] },
  { key: "辣", rhymes: ["身材超級辣🌶️", "眼神超級辣", "穿著超級辣🔥", "曲線超級辣", "今天特別辣", "美到超級辣", "這腿超級辣", "風格超級辣", "全場妳最辣", "後勁超級辣", "魅力超級辣", "真的有夠辣", "超級無敵辣", "簡直超級辣", "讓人噴火辣", "絕對超級辣", "氣場超級辣", "真的是太辣", "無敵超級辣", "看了好熱辣"] },
  { key: "絕", rhymes: ["氣質超級絕✨", "真的有夠絕", "搭配超級絕", "品味超級絕", "美貌超級絕", "這套禮服絕👗", "身材比例絕", "全場第一絕", "回頭率超絕", "驚豔程度絕", "這一刻真絕", "美得太絕了", "真的太絕了", "眼神超級絕", "笑容超級絕", "狀態超級絕", "這招真的絕", "絕對超級絕", "超級無敵絕", "真的是太絕"] },
];

// Exclamation Rhymes (Rhymes with sound)
// Strictly non-monetary, strictly rhyming, strictly 5 chars + fun
const COMMON_EXCL_RHYMES: RhymeEntry[] = [
  { key: "哇賽哇賽", rhymes: ["身材好厲害💪", "腹肌有八塊", "迷倒老太太👵", "全場都喜愛", "帥氣無法蓋", "魅力像大海🌊", "老婆最喜愛", "心情好爽快", "顏值不言敗", "幸福趁現在", "氣質好厲害", "人見人都愛❤️", "真的好厲害", "愛意滿出來", "紅線這頭牽"] }, // ㄞ
  { key: "哎唷哎唷", rhymes: ["老婆融化囉🫠", "單身結束囉", "幸福開始囉🎉", "今晚不睡囉", "聽老婆話囉", "趕快生子囉👶", "全場嗨翻囉", "口水流下囉🤤", "眼神對到囉", "緣分來到囉", "大家拍手囉👏", "氣氛很好囉", "真的不錯囉", "相愛一生囉"] }, // ㄛ
  { key: "天啊天啊", rhymes: ["帥到會爆炸💥", "全場你最大", "這婚禮太殺", "老婆娶回家🏠", "就像劉德華", "心跳七十八💓", "掌聲給他催", "幸福笑哈哈😄", "氣氛超絕佳", "人生贏家呀", "美到像幅畫🖼️", "真的是神話", "愛苗在發芽", "誰能比他誇"] }, // ㄚ
  { key: "讚嘆讚嘆", rhymes: ["帥氣不平凡", "魅力用不完", "幸福在呼喚📣", "愛意滿滿滿", "全場都驚嘆😲", "笑容多燦爛", "真情金不換", "快樂不間斷", "甜蜜的負擔", "今晚要狂歡🥳", "這餐很豐滿", "愛情金不換", "真的很美滿", "幸福來相伴"] }, // ㄢ
  { key: "閃亮閃亮", rhymes: ["全場妳最亮✨", "像月光一樣", "幸福在盪漾", "美得太誇張", "老公心花放", "人生新方向", "甜蜜太浩蕩", "快樂在歌唱🎤", "美麗不可擋", "全場都鼓掌👏", "前途更寬廣", "愛情在發光", "心情在飛揚", "真的好漂亮"] }, // ㄤ
  { key: "哎呀哎呀", rhymes: ["美得像幅畫🖼️", "心跳七十八", "口水一直擦🤤", "眼睛眨呀眨", "幸福笑哈哈", "全場你最大", "這對太搭啦", "根本是神話", "快點親嘴巴💋", "掌聲給他催", "氣氛頂呱呱", "開心到爆炸💥", "趕快娶回家", "真的是歐爸"] }, // ㄚ
  { key: "媽呀媽呀", rhymes: ["帥到會掉渣", "美到太浮誇", "心裡開滿花🌸", "趕快娶回家", "真的是歐爸", "眼睛沒眼花", "幸福到爆炸", "全場笑哈哈", "顏值太搭啦", "掌聲給他刷", "愛苗在發芽🌱", "真的是神話", "誰能比他殺", "真的很偉大"] }, // ㄚ
  { key: "歐買歐買", rhymes: ["心情好爽快😆", "幸福趁現在", "人見人都愛", "全場都喜愛", "魅力像大海🌊", "身材好厲害", "不要太見外", "永遠不分開", "逍遙又自在", "緣分天安排", "笑容好可愛😊", "氣質好厲害", "真的好厲害", "趕快生小孩"] } // ㄞ
];

const FLOWER_SUFFIXES = [
  "(墨鏡戴好！😎)", "(掌聲加尖叫！👏)", "(音樂請下！🎵)", "(High起來！🔥)", 
  "(尖叫聲！📢)", "(原地結婚！💍)", "(全場起立！🕺)", "(太閃了！✨)", 
  "(相機準備！📸)", "(幸福滿分！💯)", "(要幸福喔！❤️)", "(Love You!😘)",
  "(親一個！💋)", "(百年好合！🎎)", "(這對太神！🚀)", "(我的天！😱)",
  "(太完美了！✨)", "(真的太配了！💑)", "(永浴愛河！🌊)", "(早生貴子！👶)"
];

// ==========================================
// 2. MODULAR BULLSHIT (唬爛)
// ==========================================
// Structure: [Time] + [Action] + [Result]

const BS_TIMES = [
  "想當年", "記得那年", "上輩子", "三千年前", "在平行宇宙", "傳說中", 
  "史書記載", "昨天夢到", "很久以前", "在銀河系邊緣", "創世紀時", "恐龍時代",
  "在夢婆湯前", "秦始皇登基時", "月球漫步時", "鐵達尼號沉沒前", "在宇宙大爆炸時",
  "在盤古開天時", "在侏羅紀公園裡", "在霍格華茲時", "在漫威宇宙裡"
];
const BS_ACTIONS = [
  "仁德單手捏爆薩諾斯", "雯惠用美貌征服了外星人", "仁德發明了時光機", "兩人一起拯救了銀河系", 
  "仁德徒手蓋好了這座婚宴會館", "雯惠用眼神融化了冰河時期", "仁德跑贏了光速", "兩人解開了宇宙終極奧秘",
  "仁德收服了哥吉拉當寵物", "雯惠教會了皮卡丘說話", "仁德統一了復仇者聯盟", "兩人一起穿越了黑洞",
  "仁德教導了愛因斯坦相對論", "雯惠發明了珍珠奶茶", "仁德用念力控制了股市", "雯惠的笑容治癒了喪屍",
  "仁德用眼神逼退了海嘯", "雯惠用歌聲喚醒了沉睡的巨龍", "兩人一起改寫了物理定律", "仁德徒手接住了隕石"
];
const BS_RESULTS = [
  "才換來今生的相遇！", "才能舉辦這場世紀婚禮！", "才能修得共枕眠！", "才有了這段神仙眷侶般的愛情！",
  "才能讓月老親自為你們牽紅線！", "才能讓全場賓客驚呆！", "才能讓邱比特射出金箭！", "才成就了這段傳奇！",
  "才能讓今天的太陽為你們閃耀！", "才能讓這場婚禮驚動武林！", "才能讓地球繼續轉動！", "才有了今天這麼好吃的菜！",
  "才能讓霍格華茲發來入學通知！", "才能讓奧斯卡頒發終身成就獎！", "才能讓外星人決定不攻打地球！",
  "才有了這段傳頌千年的佳話！", "才能讓時間在這一刻為你們停留！", "才能讓全宇宙都為你們祝福！"
];

// ==========================================
// 3. MODULAR SLANG (流行語)
// ==========================================
// Structure: [Intro] + [Main] + [Ending]

const SL_INTROS = [
  "太狠了！", "我沒了！", "注意看！", "家人們誰懂啊！", "尊嘟假嘟？", 
  "我就問，", "笑死，", "沒毛病！", "確！", "好傢伙！", "這波操作...", "純愛戰士...",
  "破防了！", "急了急了！", "這場面...", "我真的會謝...", "芭比Q了(是開心的)...",
  "挖庫挖庫！", "真香！", "不可以色色！", "歸剛欸！", "降肉！"
];
const SL_MAINS = [
  "這對CP真的太狠了！", "這顏值是真實存在的嗎？", "今天的甜度全糖去冰！", "這個男人太狠了竟然娶到仙女！",
  "這婚禮排場Respect！", "你們的愛情真的泰褲辣！", "這畫面太美我不敢看！", "這狗糧我吃得心甘情願！",
  "根本是天造地設的一對！", "這幸福感直接拉滿！", "這對新人真的是YYDS！", "真的是原地結婚！",
  "這顏值我直接跪！", "這波閃光彈我給滿分！", "仁德這波操作666！", "雯惠美到讓我失語！",
  "這對新人根本是顏值天花板！", "這氣氛真的絕絕子！", "這糖發得太猛了！"
];
const SL_ENDINGS = [
  "鎖死！鑰匙我吞了！🔒", "直接暈爛～😵‍💫", "DDDD (懂得都懂)！", "祝百年好合！✨", 
  "螞蟻人都受不了啦！🐜", "一定要幸福一輩子！💖", "真的破防了！😭", "我願稱之為最強！🏆",
  "真的絕了！😍", "這門親事我準了！🙌", "快點生個寶寶吧！👶", "我的墨鏡裂開了！😎",
  "這必須按讚分享！👍", "直接納入教科書範本！📚", "我先乾為敬！🥂", 
  "這不結婚很難收場！💑", "真的太頂了！🔥", "請收下我的膝蓋！🙇"
];

// ==========================================
// 4. MODULAR FAMILIAR (裝熟)
// ==========================================
// Structure: [Call] + [Memory] + [Wish]

const FM_CALLS = [
  "嘿兄弟！", "親愛的！", "老朋友！", "仁德啊，", "雯惠啊，", 
  "好姊妹！", "好哥們！", "欸欸欸！", "親家！", "我的天！", "那個誰...", "麻吉！",
  "大兄弟！", "嘿嘿！", "哇塞！"
];
const FM_MEMORIES = [
  "記得我們以前一起翹課的日子，", "沒想到我們之中是你先結婚，", "看著你從小長大，", 
  "雖然我們很久沒聯絡了，", "記得上次一起喝酒的時候，",
  "看你終於找到歸宿，", "以前你最罩了，", "當年我們一起幹的蠢事還歷歷在目，", "記得你在學校的樣子，",
  "雖然我忘記包多少紅包了，", "看你變成熟了，", "想起以前一起打球的日子，",
  "記得你以前說要娶空姐，結果娶了個仙女，", "想起以前我們一起追逐夢想的日子，",
  "記得你以前很害羞，現在這麼大方，"
];
const FM_WISHES = [
  "真的好替你開心！", "一定要幸福給我們看喔！", "以後記得帶另一半來聚會！", "真的有種老父親的欣慰感！",
  "不準欺負人家喔！", "這場婚禮真的太棒了！", "以後家事要全包喔！",
  "祝你們早生貴子！", "下次換我結婚你要來喔！", "有空記得約吃飯！", "要一直這麼幸福喔！",
  "真的很感動！", "要當個好老公/好老婆喔！", "永遠支持你們！"
];

// ==========================================
// 5. STATIC COLLECTIONS (Expanded to 100+ items each)
// ==========================================

const MOVIE_QUOTES = [
  "「我愛你，不是因為你是誰，而是因為與你在一起時，我是誰。」—《剪刀手愛德華》",
  "「有些人的愛，像風，看不到，卻感受的到。」—《散步的記憶》",
  "「當你意識到你想和某人共度餘生，你會希望餘生盡快開始。」—《當哈利遇上莎莉》",
  "「To me, you are perfect.」—《愛是您·愛是我》",
  "「我寧願和你共度凡人短暫的一生，也不願一個人看盡這世界的滄海桑田。」—《魔戒》",
  "「愛，就是永遠不用說對不起。」—《愛的故事》",
  "「這是最好的時光，因為我們在一起。」—《花樣年華》",
  "「我能想到最浪漫的事，就是和你一起慢慢變老。」—《天外奇蹟》",
  "「你是我的一生摯愛，是我存在的理由。」—《美麗境界》",
  "「斯人若彩虹，遇上方知有。」—《怦然心動》",
  "「從現在開始，你只許對我一個人好，要寵我，不能騙我。」—《河東獅吼》",
  "「生命中每一個插曲，都為了讓我們更懂得珍惜此刻的相遇。」—《真愛每一天》",
  "「有你的地方，就是家。」—《天外奇蹟》",
  "「所謂的幸福，就是和喜歡的人一起過簡單的生活。」—《小確幸》",
  "「由於有你，我才明白愛的定義。」—《手札情緣》",
  "「愛不是彼此凝視，而是注視著同一個方向。」—《小王子》",
  "「我愛你，勝過世上的一切。」—《大亨小傳》",
  "「你讓我想成為更好的人。」—《愛在心裡口難開》",
  "「真正的愛是能喚醒靈魂的。」—《手札情緣》",
  "「我遇見你，是我這輩子最美好的事。」—《暮光之城》",
  "「只要有你在，我就無所畏懼。」—《霍爾的移動城堡》",
  "「因為你，我才相信命運。」—《西雅圖夜未眠》",
  "「你是我早上起床的動力，也是我晚上入睡的原因。」—《列若與史迪奇》",
  "「無論明天發生什麼事，我們至少擁有今天。」—《真愛挑日子》",
  "「愛情就像風，你看不到，但你能感覺到。」—《A Walk to Remember》",
  "「You complete me.」—《征服情海》",
  "「願原力與你們同在。」—《星際大戰》",
  "「Life is like a box of chocolates, with you inside.」—《阿甘正傳 (改編)》",
  "「I'm also just a girl, standing in front of a boy, asking him to love her.」—《新娘百分百》",
  "「After all, tomorrow is another day. But today is ours.」—《亂世佳人》",
  "「愛情不僅是彼此的注視，更是共同看向遠方。」—《小王子》",
  "「如果我知道什麼是愛，那是因為你。」—《赫爾曼·黑塞》",
  "「最好的愛能喚醒靈魂，使我們不斷追求成長。」—《手札情緣》",
  "「我愛你，從這裡一直到月亮，再繞回來。」—《猜猜我有多愛你》",
  "「每一天，我都更愛你一點。今天比昨天多，但比明天少。」—《羅斯蒙德·傑拉德》",
  "「無論我們的靈魂是什麼做的，他和我的靈魂是一樣的。」—《咆哮山莊》",
  "「遇見你之前，我不知道我可以這樣快樂。」—《波西傑克森》",
  "「你是我生命中缺失的那塊拼圖。」—《天生一對》",
  "「這一刻，即是永恆。」—《鐵達尼號》",
  "「我愛你3000次。」—《復仇者聯盟：終局之戰》",
  "「有的時候，最微不足道的小事，佔據了我們心裡最大的空間。」—《小熊維尼》",
  "「因為你，我現在喜歡我自己。」—《被討厭的勇氣》",
  "「你是我遲來的奇蹟。」—《美國隊長》",
  "「我要將最好的都給你。」—《神隱少女》",
  "「這世界這麼大，而我真正想去的地方，只有你的身邊。」—《霍爾的移動城堡》",
  "「愛上一個人，就是賦予他摧毀你的力量，但你卻相信他不會這麼做。」—《犯罪心理》",
  "「我不知道將去何方，但我已在路上。」—《神隱少女》",
  "「人生最大的幸福，是發現自己愛的人正好也愛著自己。」—《花木蘭》",
  "「愛，就是把別人的需求放在自己的需求之上。」—《冰雪奇緣》",
  "「只要我們在一起，這就是最完美的結局。」—《玩具總動員》",
  "「因為離開你的人越來越多，所以留下來的人就越來越重要。」—《玩具總動員2》",
  "「我不要短暫的溫存，我要你一世的陪伴。」—《霸王別姬》",
  "「有些人淪為平庸淺薄，金玉其外，而敗絮其中。可不經意間，有一天你會遇到一個彩虹般絢麗的人，從此以後，其他人就不過是匆匆浮雲。」—《怦然心動》",
  "「我一直覺得，愛上一個人，是這世上最美好的事。」—《以你的名字呼喚我》",
  "「如果你給我的，和你給別人的是一樣的，那我就不要了。」—《三毛》",
  "「夢想是什麼，夢想就是讓你感到堅持就是幸福的東西。」—《中國合夥人》",
  "「生命可以隨心所欲，但不能隨波逐流。」—《貓的報恩》",
  "「不管你曾經被傷害得有多深，總會有一個人的出現，讓你原諒之前生活對你所有的刁難。」—《魔法公主》",
  "「我們的愛，是風中之燭，雖然微弱，卻始終燃燒。」—《英倫情人》",
  "「你是我這輩子都不想解開的謎。」—《達文西密碼》",
  "「愛情不是尋找完美的人，而是學會用完美的眼光，欣賞那個不完美的人。」—《霍爾的移動城堡》",
  "「只有真愛才能融化冰封的心。」—《冰雪奇緣》",
  "「你永遠是我最偉大的冒險。」—《天外奇蹟》",
  "「我願用我的一生，換你十年的天真無邪。」—《盜墓筆記》",
  "「我喜歡你，比地球上任何人都喜歡你。」—《名偵探柯南》",
  "「幸福不是擁有多少，而是珍惜多少。」—《天外奇蹟》",
  "「因為有你，我才能成為今天的我。」—《蜘蛛人》",
  "「愛是永不止息。」—《聖經/走進非洲》",
  "「如果你能活到100歲，我希望我能活到100歲減一天，這樣我就不需要經歷沒有你的日子。」—《小熊維尼》",
  "「我愛你，不是因為你的樣子，而是因為和你在一起時，我的樣子。」—《愛在黎明破曉時》",
  "「愛是冒險，但值得一試。」—《天外奇蹟》",
  "「我願意為你，放棄所有。」—《大力士》",
  "「你是我的唯一。」—《史瑞克》",
  "「我們的故事，才剛剛開始。」—《魔髮奇緣》",
  "「愛就是把別人的快樂，看得比自己的重要。」—《冰雪奇緣》",
  "「你是我最美好的意外。」—《P.S. 我愛你》",
  "「只要我們在一起，哪裡都是家。」—《馬達加斯加》",
  "「我會愛你直到恆星燃燒殆盡。」—《超人：鋼鐵英雄》",
  "「你是我生命中最美麗的風景。」—《斷背山》",
  "「我願意與你分享我的一生。」—《暮光之城：破曉》",
  "「你是我存在的意義。」—《機械公敵》",
  "「我們的愛，超越時間與空間。」—《星際效應》",
  "「你是我心中永遠的陽光。」—《手札情緣》",
  "「我愛你，直到永遠。」—《鐵達尼號》",
  "「你是我的奇蹟。」—《第六感生死戀》",
  "「我願意為你擋下所有的子彈。」—《終極保鑣》",
  "「你是我生命中的光。」—《雷神索爾》",
  "「我愛你，勝過愛我自己。」—《大亨小傳》",
  "「你是我靈魂的伴侶。」—《西雅圖夜未眠》",
  "「只要有愛，一切都有可能。」—《灰姑娘》",
  "「你是我夢寐以求的女孩。」—《歌舞青春》",
  "「我愛你，從第一眼見到你開始。」—《羅密歐與茱麗葉》",
  "「你是我生命中最珍貴的禮物。」—《真愛至上》"
];

const CHENGYU_QUOTES = [
  "祝仁德雯惠：天作之合，鸞鳳和鳴，永結同心，百年好合！",
  "恭賀新禧！花好月圓，琴瑟和鳴，相敬如賓，白頭偕老！",
  "喜結良緣，才子佳人，珠聯璧合，美滿良緣，瓜瓞綿綿！",
  "新婚愉快！執子之手，與子偕老，恩愛有加，早生貴子！",
  "佳偶天成，郎才女貌，于飛之樂，福祿鴛鴦，永浴愛河！",
  "喜氣洋洋！龍鳳呈祥，情比金堅，海枯石爛，同心永結！",
  "緣定三生，情深似海，夫唱婦隨，樂賦唱隨，萬年富貴！",
  "相親相愛，情投意合，美滿家園，幸福永遠，甜甜蜜蜜！",
  "心心相印，舉案齊眉，比翼雙飛，神仙眷屬，天長地久！",
  "魚水相諧，玉樹瓊枝，同德同心，盟結良緣，乾坤定奏！",
  "赤繩繫足，笙磬同音，琴耽瑟好，詩題紅葉，宜室宜家！",
  "鴛鴦比翼，龍騰鳳翔，花開並蒂，喜結連理，情定終身！",
  "五世其昌，燕爾新婚，神仙眷屬，笙磬同音，琴耽瑟好！",
  "乾坤和樂，夫唱婦隨，萬年富貴，同德同心，盟結良緣！",
  "愛情永固，螽斯衍慶，鴻案相莊，如鼓琴瑟，花開並蒂！",
  "詩詠關雎，雅歌麟趾，瑞靄柏堂，祥雲瑞氣，永浴愛河！",
  "美滿良緣，郎才女貌，情比金堅，白頭偕老，相敬如賓！",
  "有情成眷，于飛之樂，天緣巧合，美滿家庭，琴瑟友之！",
  "三生石上，緣定今生，金石同心，文定吉祥，姻緣相配！",
  "百年琴瑟，百年偕老，花好月圓，福祿鴛鴦，天緣巧合！",
  "鳳凰于飛，美滿家園，琴瑟合鳴，相敬如賓，同心同德！",
  "龍鳳呈祥，龍騰鳳翔，龍飛鳳舞，花團錦簇，喜氣洋洋！",
  "金玉滿堂，金石同心，金玉良緣，金玉盟約，金碧輝煌！",
  "白頭偕老，白首同心，白髮齊眉，白頭相守，白首不離！",
  "海枯石爛，海誓山盟，海闊天空，情深似海，情深義重！",
  "天長地久，天荒地老，天作之合，天賜良緣，天生一對！",
  "心心相印，心有靈犀，心花怒放，心滿意足，心想事成！",
  "花開富貴，花好月圓，花前月下，花團錦簇，花容月貌！",
  "喜氣洋洋，喜從天降，喜出望外，喜上眉梢，喜聞樂見！",
  "福如東海，福壽雙全，福星高照，福祿雙全，福慧雙修！",
  "緣定三生，緣分天定，緣來是你，緣深情深，緣起緣滅！",
  "情比金堅，情投意合，情深似海，情真意切，情意綿綿！",
  "恩愛有加，恩重如山，恩恩愛愛，恩同再造，恩深義重！",
  "美滿良緣，美夢成真，美輪美奐，美不勝收，美意延年！",
  "佳偶天成，佳期如夢，佳人有約，佳人才子，佳話連篇！",
  "永結同心，永浴愛河，永不分離，永恆的愛，永遠幸福！",
  "鳳凰來儀，龍飛鳳舞，情定終身，相知相守，恩愛白頭！",
  "花好月圓，人月兩團圓，喜氣洋洋，幸福美滿，萬事如意！",
  "金玉良緣，郎才女貌，天作之合，百年好合，永結同心！",
  "相親相愛，相敬如賓，同心同德，白頭偕老，早生貴子！",
  "花開富貴，竹報平安，吉祥如意，心想事成，萬事大吉！",
  "五福臨門，六六大順，七星高照，八方來財，九九同心！",
  "十全十美，百事可樂，千祥雲集，萬事如意，億萬富翁！",
  "春風得意，花好月圓，喜氣洋洋，幸福美滿，萬事如意！",
  "龍馬精神，龍騰虎躍，龍飛鳳舞，龍鳳呈祥，龍年大吉！",
  "吉星高照，吉祥如意，大吉大利，萬事如意，心想事成！",
  "金榜題名，步步高升，鵬程萬里，前程似錦，大展宏圖！",
  "生意興隆，財源廣進，日進斗金，招財進寶，恭喜發財！",
  "闔家平安，身體健康，萬事如意，心想事成，大吉大利！",
  "琴瑟和鳴，鴛鴦福祿，絲蘿春秋，花好月圓，並提連理！",
  "同心永結，喜氣生輝，天賜良緣，美滿良緣，心心相印！",
  "天緣巧合，郎才女貌，良緣夙締，花開富貴，五世其昌！",
  "和樂魚水，魚水相諧，玉樹瓊枝，同德同心，盟結良緣！",
  "乾坤定奏，螽斯衍慶，鴻案相莊，如鼓琴瑟，花開並蒂！",
  "赤繩繫足，締結良緣，緣定三生，成家之始，鴛鴦壁合！",
  "文定吉祥，姻緣相配，白首成約，終身之盟，盟結良緣！",
  "許定終身，喜結連理，新婚大喜，百年好合，永浴愛河！",
  "佳偶天成，宜室宜家，瓜瓞綿綿，情比金堅，海枯石爛！",
  "天作之合，永結同心，相親相愛，才子佳人，愛情永固！",
  "螽斯衍慶，珠聯璧合，美滿良緣，郎才女貌，良緣夙締！"
];

const HUMOROUS_QUOTES = [
  "仁德啊，婚姻就是愛情的城堡！記得聽老婆的話會大富大貴喔！",
  "雯惠，如果仁德敢欺負妳，我們全場幾百人隨時準備好「處理」他！🔧",
  "恭喜仁德成功脫單！也恭喜雯惠成功收服這隻神奇寶貝！🔴",
  "今天的菜色不錯，心意有回本了！啊不對，我是說... 祝你們幸福！😋",
  "聽說結婚後這頓飯是最後一頓好料... 仁德保重！(開玩笑的)",
  "婚姻的三大秘訣：1.老婆永遠是對的 2.如果老婆錯了請參考第一條 3.薪水請上繳。共勉之！",
  "仁德，今天是你人生中最帥的一天，以後就... 還是很帥啦！😎",
  "沒想到仁德你也有今天！終於有人肯收留你了，感動落淚！😭",
  "結婚證書不只是張紙，它是合法的放閃許可證！請盡量閃瞎我們！😎",
  "仁德，以後家事全包、薪水全交、老婆說好就是好，這樣日子才會好！",
  "雯惠，退貨期限已過，商品售出概不退換喔！請安心使用！📦",
  "恭喜你們進入人生的「雙人副本」，難度提升，但獎勵是「幸福一輩子」！🎮",
  "今天新娘這麼美，新郎這麼帥，我只能說... 真的太不公平了！😍",
  "祝你們生一對可愛的寶寶，然後... 交給阿公阿嬤帶，你們繼續談戀愛！👶",
  "仁德，你的黃金單身漢稱號今日正式註銷！恭喜升級為人夫！",
  "雯惠，請一定要好好照顧我們家仁德，他雖然傻傻的但很愛妳！",
  "婚姻就像便當，雖然不知道裡面有什麼菜，但兩個人一起吃就是香！",
  "恭喜仁德解鎖成就：【娶到美嬌娘】！EXP +10000！",
  "仁德，記得你的膝蓋除了跪算盤，還可以用來求婚，今天不用跪算盤了吧？",
  "婚姻是愛情的墳墓？不，是愛情的別墅！只要記得繳房貸（薪水）。",
  "恭喜仁德，終於有人願意接手你的下半生，這是積了多少陰德！",
  "雯惠，妳的眼光真的... 很獨特！但我相信妳是經過深思熟慮的！",
  "祝你們吵架永遠是仁德先道歉，冷戰永遠是仁德先認輸！",
  "今天的紅酒好喝，新娘好美，新郎... 領帶很直！",
  "仁德，以後打電動的時間可能要分一點給洗碗囉！加油！",
  "結婚後，仁德的錢包就是雯惠的錢包，雯惠的錢包還是雯惠的錢包！",
  "恭喜仁德加入「怕老婆俱樂部」，會員編號 82619！",
  "雯惠，如果仁德不乖，記得告訴我們，我們負責笑他！",
  "仁德，這下你逃不掉了吧！被套牢的感覺如何？",
  "祝你們生個足球隊，這樣仁德以後看球賽就不怕沒伴了！",
  "婚姻就像二人三腳，協調很重要，不然會一起摔倒！",
  "仁德，以後你的副駕駛座永遠被預訂了！",
  "雯惠，恭喜妳獲得一個免費的司機、搬運工和提款機！",
  "仁德，記得每天都要說「老婆我愛妳」，這比吃飯還重要！",
  "祝你們的愛情像Wifi一樣，訊號滿格，永不斷線！",
  "仁德，以後看妹的權利正式被剝奪，請專注於家裡的仙女！",
  "雯惠，恭喜妳成功馴服了一頭... 呃，一隻可愛的柴犬！",
  "婚姻是一場長跑，記得配速，不要一開始就衝太快（指生小孩）！",
  "仁德，以後你的快樂就是雯惠的快樂，你的痛苦... 還是你自己的！",
  "祝你們天天像情人節，夜夜像洞房花燭夜！",
  "聽說結婚會變胖，仁德你已經在路上了嗎？",
  "雯惠，恭喜妳成功阻止了仁德繼續危害人間！",
  "仁德，以後你的私房錢記得藏好，雖然一定會被找到！",
  "祝你們的愛情像榴槤一樣，外表帶刺但內心甜美！",
  "仁德，記得老婆的快樂就是家庭的快樂！",
  "雯惠，請盡情使喚仁德，他很耐操的！",
  "祝你們的愛情像小強一樣，打不死，滅不掉！",
  "仁德，以後你的時間都不是你的時間，是老婆的時間！",
  "恭喜你們成為合法夫妻，現在可以合法吵架了！",
  "仁德，記得老婆的生日比你自己的生日還重要！",
  "祝你們的愛情像披薩一樣，熱騰騰又牽絲！",
  "仁德，以後你的肚子會越來越大，但老婆會越來越美！",
  "雯惠，請把仁德當成寵物養，定時餵食，偶爾帶出去散步！",
  "祝你們的愛情像珍珠奶茶一樣，又甜又有嚼勁！",
  "仁德，記得家裡的遙控器歸老婆管！",
  "恭喜你們，現在可以一起繳稅了！",
  "仁德，以後你的任務就是負責賺錢養家，老婆負責貌美如花！",
  "祝你們的愛情像麻辣鍋一樣，又麻又辣又過癮！",
  "仁德，記得老婆的笑容是你最大的財富！",
  "雯惠，請把仁德的信用卡當成妳的信用卡！",
  "祝你們的愛情像雲霄飛車一樣，刺激又好玩！",
  "仁德，以後你的副駕駛座只能坐老婆，連狗都不行！",
  "恭喜你們，現在可以一起面對生活的柴米油鹽了！"
];

const SENTIMENTAL_QUOTES = [
  "看著你們一路走來，兩千多個日子的點點滴滴，今天終於開花結果，真的好感動。",
  "愛不是彼此凝視，而是注視著同一個方向。願你們未來的風景，依然有彼此相伴。",
  "在這個廣大的世界裡，兩顆心能相遇、相知、相守，是多麼不容易的奇蹟。",
  "願你們的愛，像今天的陽光一樣溫暖，像歲月一樣綿長。",
  "婚姻是承諾，也是責任。看到你們眼中的光芒，我相信你們一定會很幸福。",
  "從今以後，風雨同舟。願你們成為彼此最堅強的後盾，最溫暖的避風港。",
  "這不只是一場婚禮，更是一段美麗旅程的開始。請緊緊牽著對方的手，不要放開。",
  "願歲月靜好，現世安穩，你們的愛情永遠如初見般美好。",
  "喜歡是乍見之歡，愛是久處不厭。祝福你們的愛，歷久彌新。",
  "願你們在未來的日子裡，依然能像現在一樣，看著對方笑得如此燦爛。",
  "最好的愛情，不是完美無缺，而是兩個人一起努力，讓生活變得更美好。",
  "今天，是你們故事的新篇章。願這本書的每一頁，都寫滿了幸福與快樂。",
  "願你們的家，充滿笑聲、溫暖與愛，成為世上最美好的角落。",
  "因為有愛，所以無畏。祝福你們在未來的路上，攜手共度每一個春夏秋冬。",
  "愛情最美的樣子，就是你們現在看著對方的眼神。",
  "願你們的愛情，不只在婚禮這天盛開，而是在未來的柴米油鹽中依然芬芳。",
  "兩個人相愛，不是為了改變對方，而是為了在對方的眼中看見更好的自己。",
  "願你們把平淡的日子，過成如詩如畫的歲月。",
  "從此刻起，你們的名字緊緊相連，命運也緊緊相依。祝福你們。",
  "願你們的愛情，像陳年的酒，越久越香醇。",
  "相遇是緣分，相守是福分。珍惜這份來之不易的幸福。",
  "願你們的愛如高山般堅定，如流水般長流。",
  "在愛情的道路上，願你們永遠是彼此最好的旅伴。",
  "婚姻不是愛情的終點，而是另一種深情的開始。",
  "願你們的每一天都比昨天更相愛。",
  "祝福你們，在平凡的日子裡創造出不平凡的幸福。",
  "願你們的愛情故事，成為這世上最動人的傳說。",
  "兩顆心的靠近，是為了溫暖彼此的生命。",
  "願你們的愛，能抵擋世間所有的風雨。",
  "看著你們幸福的樣子，我也相信了愛情。",
  "願你們的未來，充滿了驚喜與感動。",
  "愛是包容，愛是理解，愛是你們現在的樣子。",
  "祝福你們，白頭偕老，永浴愛河。",
  "願你們的愛情，像繁星一樣閃耀，像大海一樣深邃。",
  "牽了手，就不要輕易放開。祝你們幸福永遠。",
  "愛情的意義，在於兩個人一起變老。",
  "願你們的笑容，永遠像今天一樣甜美。",
  "因為愛，所以懂得珍惜。祝福你們。",
  "願你們的家，是愛開始的地方。",
  "執子之手，與子偕老，這是最美的誓言。",
  "願你們的愛情，經得起時間的考驗。",
  "相愛容易相處難，願你們珍惜彼此的每一刻。",
  "願你們的生命中，永遠充滿了愛與被愛。",
  "祝福你們，用愛寫下最美的篇章。",
  "願你們的愛情，像花朵一樣盛開，像大樹一樣茁壯。",
  "兩個人在一起，就是最大的幸福。",
  "願你們的每一天，都充滿了陽光與希望。",
  "愛是永恆的承諾，願你們守護彼此到永遠。",
  "願你們的愛情，像鑽石一樣璀璨，像黃金一樣珍貴。",
  "祝福你們，擁有一個溫暖的家，一個相愛的人。",
  "願你們的愛，溫暖彼此的心房。",
  "相知相守，是人生最美的風景。",
  "願你們的愛情，像細水長流，永不乾涸。",
  "祝福你們，幸福滿滿，愛意濃濃。",
  "願你們的未來，充滿了無限的可能。",
  "愛是陪伴，愛是守護，愛是你們在一起的樣子。",
  "願你們的愛情，像童話一樣美好。",
  "祝福你們，恩愛一生，幸福一世。",
  "願你們的愛，照亮彼此的人生。",
  "相愛是緣，相守是份，願你們緣分天長地久。"
];

const POEM_QUOTES = [
  "仁風播送暖陽春，德澤流長福滿門，雯彩祥雲天上降，惠心蘭質配良人。",
  "兩姓聯姻情意濃，千秋佳話永傳頌，百年琴瑟聲聲和，花燭洞房樂無窮。",
  "桃之夭夭灼其華，之子于歸宜室家，三星在戶結良緣，五世其昌福無涯。",
  "仁愛相隨情意長，德行兼備譜華章，雯華耀眼映紅妝，惠質蘭心伴身旁。",
  "金風玉露一相逢，便勝卻人間無數。願兩情長久，朝朝暮暮。",
  "關關雎鳩，在河之洲。窈窕淑女，君子好逑。今得佳偶，夫復何求。",
  "身無彩鳳雙飛翼，心有靈犀一點通。今日結髮，共度此生。",
  "春風得意馬蹄疾，一日看盡長安花。洞房花燭夜，金榜題名時。",
  "願得一心人，白頭不相離。執手共白髮，此生不分離。",
  "結髮為夫妻，恩愛兩不疑。歡娛在今夕，嬿婉及良時。",
  "死生契闊，與子成說。執子之手，與子偕老。",
  "願我如星君如月，夜夜流光相皎潔。",
  "上邪！我欲與君相知，長命無絕衰。",
  "既見君子，云胡不喜。",
  "玲瓏骰子安紅豆，入骨相思知不知。",
  "曾經滄海難為水，除卻巫山不是雲。取次花叢懶回顧，半緣修道半緣君。",
  "願君多采擷，此物最相思。",
  "山無陵，江水為竭，冬雷震震，夏雨雪，天地合，乃敢與君絕。",
  "在此佳期，共鑒鴛鴦比翼；願此生，同看雲捲雲舒。",
  "琴瑟在御，莫不靜好。",
  "宜言飲酒，與子偕老。琴瑟在御，莫不靜好。",
  "投我以木瓜，報之以瓊琚。匪報也，永以為好也。",
  "青青子衿，悠悠我心。但為君故，沉吟至今。",
  "執子之手，與子偕老。于嗟闊兮，不我活兮。于嗟面兮，不我信兮。",
  "天涯地角有窮時，只有相思無盡處。",
  "兩情若是久長時，又豈在朝朝暮暮。",
  "在天願作比翼鳥，在地願為連理枝。",
  "眾里尋他千百度，驀然回首，那人卻在，燈火闌珊處。",
  "衣帶漸寬終不悔，為伊消得人憔悴。",
  "問世間，情為何物，直教生死相許。",
  "還君明珠雙淚垂，恨不相逢未嫁時。",
  "相思相見知何日？此時此夜難為情。",
  "人生自是有情痴，此恨不關風與月。",
  "多情只有春庭月，猶為離人照落花。",
  "天不老，情難絕。心似雙絲網，中有千千結。",
  "直道相思了無益，未妨惆悵是清狂。",
  "深知身在情長在，悵望江頭江水聲。",
  "平生不會相思，才會相思，便害相思。",
  "入我相思門，知我相思苦。",
  "淒涼別後兩應同，最是不勝清怨月明中。",
  "相思樹底說相思，思郎恨郎郎不知。",
  "若教眼底無離恨，不信人間有白頭。",
  "尊前擬把歸期說，未語春容先慘咽。",
  "一種相思，兩處閒愁。",
  "有美人兮，見之不忘，一日不見兮，思之如狂。",
  "這次第，怎一個愁字了得。",
  "只願君心似我心，定不負相思意。",
  "換我心，為你心，始知相憶深。",
  "憶君心似西江水，日夜東流無歇時。",
  "春蠶到死絲方盡，蠟炬成灰淚始乾。",
  "相見時難別亦難，東風無力百花殘。",
  "人面不知何處去，桃花依舊笑春風。",
  "此情可待成追憶，只是當時已惘然。",
  "紅豆生南國，春來發幾枝。",
  "郎騎竹馬來，繞床弄青梅。",
  "月上柳梢頭，人約黃昏後。",
  "花自飄零水自流。",
  "莫道不銷魂，簾捲西風，人比黃花瘦。",
  "柔情似水，佳期如夢，忍顧鵲橋歸路。",
  "金風玉露一相逢，便勝卻人間無數。",
  "兩情若是久長時，又豈在朝朝暮暮。"
];

const HAPPY_QUOTES = [
  "太～棒～啦～！！🎉 恭喜恭喜！全場嗨起來！",
  "喔耶！！這場婚禮太讚了！一定要幸福喔喔喔！🥳",
  "Happy Wedding!! 祝你們每一天都像今天一樣開心！✨",
  "尖叫聲在哪裡！！🙌 恭喜仁德！恭喜雯惠！",
  "哇嗚～！這畫面太美我不敢看！祝你們甜甜蜜蜜每一天！🍬",
  "乾杯！🍻 為了這對世界上最棒的新人！Cheers!",
  "超級大恭喜！這絕對是今年最棒的消息！❤️❤️❤️",
  "熱烈祝賀！願你們的愛火永遠燃燒！🔥",
  "恭喜發財... 阿不是，是恭喜結婚！大吉大利！幸福滿滿！🧧",
  "放鞭炮啦！🧨 慶祝這對金童玉女終於修成正果！",
  "太感人了！太開心了！一定要幸福到永遠喔！🥰",
  "全場的目光都在你們身上！享受這一天吧！🌟",
  "把手借給我！一起為這對新人歡呼！👏👏👏",
  "今天不醉不歸！為了慶祝這份偉大的愛情！🍷",
  "歡呼聲加尖叫！這對新人真的太速配啦！",
  "恭喜恭喜！紅包大放送... 喔不，是祝福大放送！",
  "灑花灑花！🌸 祝你們幸福美滿，早生貴子！",
  "這真的是太Happy了！我都想再結一次婚了！(誤)",
  "全場High起來！把屋頂掀翻吧！🙌",
  "這對新人顏值爆表，幸福指數爆表！📈",
  "恭喜老爺！賀喜夫人！祝你們百年好合！",
  "今天真是個好日子！大家都沾沾喜氣！",
  "哇！這場面太盛大了！祝你們新婚快樂！",
  "恭喜仁德抱得美人歸！恭喜雯惠嫁給好老公！",
  "太開心了！一定要一直這麼幸福下去喔！",
  "祝你們每天都像蜜月一樣甜！",
  "恭喜你們！這就是愛情最美的樣子！",
  "太感動了！我都快哭了！祝你們幸福！",
  "耶！終於等到這一天了！恭喜你們！",
  "祝你們的愛情像火箭一樣一飛沖天！🚀",
  "恭喜！這絕對是年度最佳婚禮！🏆",
  "太完美了！祝你們白頭偕老！",
  "恭喜恭喜！早點生個胖娃娃！👶",
  "祝你們幸福久久，快樂久久！99！",
  "太棒了！為你們感到驕傲！",
  "恭喜畢業！單身大學正式畢業！🎓",
  "祝你們的愛情像可樂一樣，氣泡滿滿！🥤",
  "太讚了！這場婚禮真的太好玩了！",
  "恭喜你們解鎖人生新成就！🏆",
  "祝你們天天開心，事事順心！",
  "恭喜恭喜！紅包拿來... 開玩笑的，祝福拿去！",
  "太幸福了！我都想戀愛了！",
  "恭喜仁德！恭喜雯惠！要一直相愛喔！",
  "祝你們的愛情像太陽一樣，永遠發光發熱！☀️",
  "太美好了！這就是我嚮往的婚禮！",
  "恭喜恭喜！百年好合，永結同心！",
  "祝你們生一打足球隊！⚽",
  "太High了！今晚不醉不歸！",
  "恭喜你們！找到了彼此的靈魂伴侶！",
  "祝你們的愛情像美酒一樣，越陳越香！🍷",
  "太棒了！一定要幸福喔！",
  "恭喜恭喜！早生貴子，多子多孫！",
  "祝你們的愛情像花朵一樣，永遠盛開！🌸",
  "太感人了！這是我參加過最棒的婚禮！",
  "恭喜你們！要一直牽手走下去喔！",
  "祝你們的愛情像星星一樣，永遠閃耀！⭐",
  "太開心了！為你們感到高興！",
  "恭喜恭喜！白頭偕老，永浴愛河！",
  "祝你們的愛情像大海一樣，深不可測！🌊",
  "太幸福了！一定要珍惜彼此喔！",
  "恭喜你們！開啟了幸福的大門！"
];

/**
 * Generate a random guest message locally.
 * Simulates a delay to mimic "AI thinking".
 */
export const generateGuestMessage = async (style: string, guestName: string): Promise<string> => {
  const name = guestName || '我';

  // Simulate "Thinking" delay
  await new Promise(resolve => setTimeout(resolve, 600));

  let message = "";

  switch (style) {
    case 'flower':
      const isGroom = Math.random() > 0.5;
      
      // FIXED: Names are now prepended at assembly time, not in title list
      // Previously: targetName="仁德", title="仁德哥哥" -> "仁德仁德哥哥"
      // Now: targetName="仁德", title="哥哥" -> "仁德哥哥"
      
      let targetName, titles;
      let adjConfig: RhymeEntry[];
      
      if (isGroom) {
        targetName = GROOM_NAME;
        titles = GROOM_TITLES;
        adjConfig = GROOM_ADJ_RHYMES;
      } else {
        targetName = BRIDE_NAME;
        titles = BRIDE_TITLES;
        adjConfig = BRIDE_ADJ_RHYMES;
      }

      // 1. Pick Title
      const title = pick(titles); // e.g., "哥哥"
      
      // 2. Part 1: Adjective Rhyme
      const adjEntry = pick(adjConfig);
      const adj = adjEntry.key;
      const adjPhrase = pick(adjEntry.rhymes); // Ends with the adj
      
      // 3. Part 2: Exclamation Rhyme
      const exclEntry = pick(COMMON_EXCL_RHYMES);
      const excl = exclEntry.key;
      const exclPhrase = pick(exclEntry.rhymes); // Rhymes with excl
      
      // 4. Outro
      const suffix = pick(FLOWER_SUFFIXES);

      // Assemble with Strict Rhythm
      message = `${targetName}${title}，${name}來接你了唷！ 來囉來囉～ ${adj}～好${adj}～ ${targetName}${title}${adjPhrase}！ ${excl}～ ${targetName}${title}${exclPhrase}！ 掰掰～我們入席囉！ ${suffix}`;
      break;

    case 'movie':
      message = pick(MOVIE_QUOTES);
      break;

    case 'slang':
      // Modular assembly
      message = `${pick(SL_INTROS)} ${pick(SL_MAINS)} ${pick(SL_ENDINGS)}`;
      break;
      
    case 'chengyu':
      message = pick(CHENGYU_QUOTES);
      break;

    case 'bullshit':
      // Modular assembly
      message = `聽說${pick(BS_TIMES)}，${pick(BS_ACTIONS)}，${pick(BS_RESULTS)} 恭喜兩位！`;
      break;

    case 'humorous':
      message = pick(HUMOROUS_QUOTES);
      break;

    case 'sentimental':
      message = pick(SENTIMENTAL_QUOTES);
      break;

    case 'happy':
      // Modular assembly for Happy? Or just pick. 
      // Let's mix it up: 30% chance to combine two happy quotes if they are short, otherwise pick one.
      const baseHappy = pick(HAPPY_QUOTES);
      if (baseHappy.length < 15 && Math.random() > 0.5) {
         message = `${baseHappy} ${pick(HAPPY_QUOTES)}`;
      } else {
         message = baseHappy;
      }
      break;
      
    case 'familiar':
      // Modular assembly
      message = `${pick(FM_CALLS)} ${pick(FM_MEMORIES)} ${pick(FM_WISHES)}`;
      break;

    case 'poem':
      message = pick(POEM_QUOTES);
      break;

    default:
      message = "新婚快樂，永浴愛河！";
  }

  // Ensure personal touch (randomly append signature if not present)
  if (!message.includes(name) && style !== 'flower' && style !== 'bullshit' && style !== 'familiar') {
    if (Math.random() > 0.7) {
      message += ` (By ${name})`;
    }
  }

  return message;
};

/**
 * Generate a standard email summary without AI.
 */
export const generateEmailSummary = async (data: FormData): Promise<string> => {
  return `
    Wedding RSVP Submission
    =======================
    
    [Guest Information]
    Name: ${data.fullName}
    Relation: ${data.relationship}
    Attendance: ${data.attendance}
    Phone: ${data.phone}
    Email: ${data.email}
    
    [Logistics]
    Total People: ${data.attendeeCount}
    Child Seats: ${data.childSeats}
    Vegetarian Meals: ${data.vegetarianCount}
    
    [Message to Couple]
    ${data.comments || '(No message)'}
    
    -----------------------
    Generated by Wedding RSVP App
  `;
};
